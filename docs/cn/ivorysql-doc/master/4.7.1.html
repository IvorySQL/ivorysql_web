<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>安装说明 :: IvorySQL文档中心</title>
    <link rel="canonical" href="https://docs.ivorysql.org/ivorysql-doc/master/4.7.1.html">
    <link rel="prev" href="4.4.html">
    <link rel="next" href="4.7.2.html">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.ivorysql.org">IvorySQL文档中心</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://www.ivorysql.org/">官方网站</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ivorysql-doc" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="welcome.html">文档中心</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">IvorySQL</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="welcome.html">欢迎</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="1.html">发行说明</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="2.html">关于IvorySQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">IvorySQL入门</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="3.1.html">快速开始</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="3.2.html">日常监控</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="3.3.html">日常维护</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">IvorySQL高级</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="4.1.html">安装指南</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="4.2.html">集群搭建</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="4.5.html">迁移指南</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="4.3.html">开发者指南</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">容器化指南</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="4.6.1.html">K8S部署</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="4.6.2.html">Operator部署</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="4.6.4.html">Docker &amp; Podman部署</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="4.6.3.html">Docker Swarm &amp; Docker Compose部署</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="4.4.html">运维管理指南</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">云服务平台指南</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="4.7.1.html">IvorySQL Cloud安装</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="4.7.2.html">IvorySQL Cloud使用</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">IvorySQL生态</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cpu_arch_adp.html">芯片架构适配</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="os_arch_adp.html">操作系统适配</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">生态组件适配</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.0.html">概述</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.1.html">postgis</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.2.html">pgvector</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.3.html">pgddl(DDL Extractor)</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.4.html">pg_cron</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.5.html">pgsql-http</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.6.html">plpgsql_check</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.7.html">pgroonga</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.8.html">pgaudit</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.9.html">pgrouting</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="5.10.html">system_stats</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">IvorySQL架构设计</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">查询处理</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.1.1.html">双parser</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">兼容框架</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="7.1.html">框架设计</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="7.2.html">GUC框架</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="7.4.html">双模式设计</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.2.1.html">initdb过程</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">兼容特性</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.1.html">like</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.3.html">RowID</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.2.html">OUT 参数</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.4.html">%TYPE、%ROWTYPE</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.5.html">NLS 参数</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.6.html">函数与存储过程</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.7.html">嵌套子函数</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.8.html">Force View</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.9.html">大小写转换</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.10.html">sys_guid 函数</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.11.html">空字符串转null</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.3.12.html">CALL INTO</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">内置函数</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.4.1.html">sys_context</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="6.4.2.html">userenv</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="6.5.html">国标GB18030</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Oracle兼容功能列表</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.3.html">1、大小写转换</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.5.html">2、LIKE操作符</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.6.html">3、匿名块</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.7.html">4、函数与存储过程</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.8.html">5、内置数据类型与内置函数</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.9.html">6、端口与IP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.10.html">7、XML函数</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.11.html">8、sequence</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.12.html">9、包</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.13.html">10、不可见列</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.14.html">11、RowID</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.15.html">12、OUT 参数</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.16.html">13、%TYPE、%ROWTYPE</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.17.html">14、NLS 参数</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.18.html">15、Force View</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.19.html">16、嵌套子函数</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.20.html">17、sys_guid 函数</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.21.html">18、空字符串转null</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="7.22.html">19、CALL INTO</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">IvorySQL贡献指南</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="8.1.html">社区贡献指南</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="8.2.html">asciidoc语法快速参考</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="9.html">工具参考</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="10.html">FAQ</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PostgreSQL</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="100.html">PG参数参考手册</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="110.html">PG函数参考手册</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">文档中心</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="welcome.html">文档中心</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="welcome.html">master</a>
        </li>
        <li class="version">
          <a href="../v5.1/v5.1/welcome.html">v5.1</a>
        </li>
        <li class="version">
          <a href="../v5.0/v5.0/welcome.html">v5.0</a>
        </li>
        <li class="version">
          <a href="../v4.6/v4.6/welcome.html">v4.6</a>
        </li>
        <li class="version">
          <a href="../v1.17/v1.17/welcome.html">v1.17</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="welcome.html">文档中心</a></li>
    <li>IvorySQL</li>
    <li>IvorySQL高级</li>
    <li>云服务平台指南</li>
    <li><a href="4.7.1.html">IvorySQL Cloud安装</a></li>
  </ul>
</nav>
  <div class="page-versions">
  <button class="version-menu-toggle" title="switch to English">CN</button>
  <div class="version-menu">
    <a class="version is-current" href="">CN</a>
    <a class="version" href="../../../../en/ivorysql-doc/master/4.7.1.html">EN</a>
  </div>
  </div>
  <div class="edit-this-page"><a href="https://github.com/IvorySQL/ivorysql_docs/edit/master/CN/modules/ROOT/pages/master/4.7.1.adoc">编辑此页面</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="目录" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">安装说明</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>IvorySQL Cloud平台是一个综合性的解决方案，它集成了IvorySQL数据库以及周边生态，以提供全面的数据库和资源管理功能。安装前需要上github编译安装好</p>
</div>
<div class="paragraph">
<p>前端：https://github.com/IvorySQL/ivory-cloud-web</p>
</div>
<div class="paragraph">
<p>后端：https://github.com/IvorySQL/ivory-cloud</p>
</div>
<div class="paragraph">
<p>搭建好K8S集群，并在集群master节点上安装ivory-operator</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/IvorySQL/ivory-operator/tree/IVYO_REL_5_STABLE" class="bare">https://github.com/IvorySQL/ivory-operator/tree/IVYO_REL_5_STABLE</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ivorysql-cloud平台安装"><a class="anchor" href="#ivorysql-cloud平台安装"></a>1. IvorySQL Cloud平台安装</h2>
<div class="sectionbody">
<div class="paragraph">
<p>IvorySQL Cloud平台，目前支持Linux系统下的安装，以下为各部分对应的安装包：</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 99%;">
<colgroup>
<col style="width: 28%;">
<col style="width: 72%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">组件</th>
<th class="tableblock halign-left valign-top">安装包</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">前端</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">后端</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cloudnative-1.0-SNAPSHOT.jar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">K8S集群</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>docker.io/ivorysql/ivory-operator:v5.0</p>
</li>
<li>
<p>docker.io/ivorysql/pgadmin:ubi8-9.9-5.0-1</p>
</li>
<li>
<p>docker.io/ivorysql/pgbackrest:ubi8-2.56.0-5.0-1</p>
</li>
<li>
<p>docker.io/ivorysql/postgres-exporter:ubi8-0.17.0-5.0-1</p>
</li>
<li>
<p>docker.io/ivorysql/ivorysql:ubi8-5.0-5.0-1</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>另外，云服务平台还需要用户安装以下组件：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>后端数据库</strong>：负责存储和管理所有与云资源、用户信息、权限控制、计费信息等相关的数据。需要使用PG系列数据库，如PostgreSQL、瀚高数据库、IvorySQL等。</p>
</li>
<li>
<p><strong>NGINX</strong>：支持云服务平台的web服务。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="安装前准备"><a class="anchor" href="#安装前准备"></a>2. 安装前准备</h2>
<div class="sectionbody">
<div class="paragraph">
<p>安装前，所有服务器都必须完成以下准备工作。并且将IvorySQL Cloud平台部署在K8S（1.23）的服务器上，且该K8S集群需要有默认的storage class.</p>
</div>
<div class="sect2">
<h3 id="关闭防火墙"><a class="anchor" href="#关闭防火墙"></a>2.1. 关闭防火墙</h3>
<div class="paragraph">
<p>所有服务器关闭防火墙，以保证他们之间的网络互通。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>systemctl stop firewalld.service

systemctl disable firewalld.service</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="后端部署"><a class="anchor" href="#后端部署"></a>2.2. 后端部署</h3>
<div class="sect3">
<h4 id="后端数据库"><a class="anchor" href="#后端数据库"></a>2.2.1. 后端数据库</h4>
<div class="paragraph">
<p>IvorySQL Cloud平台的后端数据库需用户自行安装，请参考IvorySQL官网。</p>
</div>
</div>
<div class="sect3">
<h4 id="后端服务程序"><a class="anchor" href="#后端服务程序"></a>2.2.2. 后端服务程序</h4>
<div class="sect4">
<h5 id="编译后端服务程序"><a class="anchor" href="#编译后端服务程序"></a>2.2.2.1. 编译后端服务程序</h5>
<div class="literalblock">
<div class="content">
<pre># 克隆代码

git clone https://github.com/IvorySQL/ivory-cloud.git

# 进入到项目根目录

cd ivory-cloud</pre>
</div>
</div>
<div class="paragraph">
<p>请确保ivory-cloud\cloudnative\src\main\resources\monitor文件夹，及其所有的子文件夹下的以.sh结尾的文件是unix格式的，如果不是，请执行dos2unix命令转换成unix格式。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>dos2unix cloudnative\src\main\resources\monitor\*

# 编译

mvn clean

mvn package -D maven.test.skip=true

打包完成后，可以在 ivory-cloud/cloudnative/target下找到cloudnative-1.0-SNAPSHOT.jar文件</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="部署程序"><a class="anchor" href="#部署程序"></a>2.2.2.2. 部署程序</h5>
<div class="literalblock">
<div class="content">
<pre>在K8S服务器上执行如下操作：

# 创建目录

mkdir -p /home/ivory

# 将上一步编译好的文件ivory-cloud/cloudnative/target/cloudnative-1.0-SNAPSHOT.jar上传至上述目录

# 配置文件

## 创建配置目录

mkdir -p /home/ivory/config

## 上传配置文件

将源代码ivory-cloud/cloudnative/src/main/resources目录里的如下三个配置文件上传至 /home/ivory/config

application.yaml

application-native.yaml

spring_pro_logback.xml

## 修改配置文件，请将url、username、password修改为&lt;&lt;backend-db,后端数据库章节&gt;&gt;安装的数据库的信息。

## /home/ivory/config/application-native.yaml

datasource:

druid:

db-type: com.alibaba.druid.pool.DruidDataSource

driver-class-name: org.postgresql.Driver

url: jdbc:postgresql://127.0.0.1:5432/ivorysql

username: ivorysql

password: "ivory@123"</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="启动后端服务程序"><a class="anchor" href="#启动后端服务程序"></a>2.2.3. 启动后端服务程序</h4>
<div class="literalblock">
<div class="content">
<pre># 安装jdk1.8

yum install -y java-1.8.0-openjdk.x86_64

[root@cloud ivory]# pwd

/home/ivory/

[root@cloud ivory]# nohup java -jar cloudnative-1.0-SNAPSHOT.jar &gt; log_native 2&gt;&amp;1 &amp;

[root@cloud ivory]# ps -ef |grep java

root 77494 1 0 10月09 ? 00:03:07 java -jar cloudnative-1.0-SNAPSHOT.jar</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="前端部署"><a class="anchor" href="#前端部署"></a>2.3. 前端部署</h3>
<div class="sect3">
<h4 id="编译前端服务程序"><a class="anchor" href="#编译前端服务程序"></a>2.3.1. 编译前端服务程序</h4>
<div class="literalblock">
<div class="content">
<pre>## 获取代码

git clone https://github.com/IvorySQL/ivory-cloud-web.git

## 进入项目根目录

cd ivorysql-cloud-web

## 安装依赖

npm install

## 编译打包

npm run build:prod</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="修改目录和文件权限"><a class="anchor" href="#修改目录和文件权限"></a>2.3.2. 修改目录和文件权限</h4>
<div class="literalblock">
<div class="content">
<pre># 创建目录

[root@cloud opt]# mkdir -p /opt/cloud/web

# 将前端构建后的dist文件夹置于/opt/cloud/web

# 授权

[root@cloud web]# chmod 755 /opt/cloud/web/dist

[root@cloud web]# chmod -R 777 /opt/cloud/web/dist</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="修改config-js"><a class="anchor" href="#修改config-js"></a>2.3.3. 修改config.js</h4>
<div class="paragraph">
<p>修改文件</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[root@cloud dist]# pwd

/home/cloud/web/dist

[root@cloud dist]# vi config.js

var PLATFROM_CONFIG = {};

// ip请更换为当前服务器地址

PLATFROM_CONFIG.baseUrl = "http://192.168.31.43:8081/cloudapi/api/v1"

//true: need to show "注册" on login page

//false: don't show "注册" on login page

globalShowRegister = true

//是否隐藏云原生数据库， true: 隐藏云原生数据库；false:显示云原生数据库

disableNative = false

// 数据库类型

dbtype = "IvorySQL"

dbversion = "5.0"</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="安装部署nginx"><a class="anchor" href="#安装部署nginx"></a>2.4. 安装部署nginx</h3>
<div class="paragraph">
<p>IvorySQL Cloud平台服务器需要安装nginx，以支持云服务平台的web服务。nginx需要用户自行安装，这里提供一种安装方法作为参考。</p>
</div>
<div class="sect3">
<h4 id="下载nginx安装包"><a class="anchor" href="#下载nginx安装包"></a>2.4.1. 下载nginx安装包</h4>
<div class="literalblock">
<div class="content">
<pre>[root@cloud web]# wget https://nginx.org/download/nginx-1.20.1.tar.gz

[root@cloud web]# ls -lrt

总用量 3924

-rwxrwxr-x. 1 root root 1061461 5月 25 2021 nginx-1.20.1.tar.gz

-rwxrwxr-x. 1 root root 2943732 10月 9 16:43 dist.tar.gz

drwxrwxrwx. 4 root root 103 10月 21 13:20 dist</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="安装相关依赖"><a class="anchor" href="#安装相关依赖"></a>2.4.2. 安装相关依赖</h4>
<div class="literalblock">
<div class="content">
<pre>[root@host30 cloud]# yum -y install pcre-devel

[root@host30 cloud]# yum -y install openssl openssl-devel</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="编译安装nginx"><a class="anchor" href="#编译安装nginx"></a>2.4.3. 编译安装nginx</h4>
<div class="paragraph">
<p>nginx会被安装在configure时由&#8212;&#8203;prefix指定的目录下，例如这里的/opt/cloud/nginx：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>## 解压缩nginx-1.20.1.tar.gz安装包

[root@cloud web]# tar -zxvf nginx-1.20.1.tar.gz

## 解压后生成nginx-1.20.1文件夹

[root@cloud web]# ls -lrt

总用量 3924

-rwxrwxr-x. 1 root root 1061461 5月 25 2021 nginx-1.20.1.tar.gz

-rwxrwxr-x. 1 root root 2943732 10月 9 16:43 dist.tar.gz

drwxrwxr-x. 9 1001 1001 186 10月 9 16:53 nginx-1.20.1

drwxrwxrwx. 4 root root 103 10月 21 13:20 dist

## 配置导向

[root@cloud web]# cd nginx-1.20.1

[root@cloud nginx-1.20.1]# ./configure --prefix=/opt/cloud/nginx --with-http_ssl_module

## 编译安装

[root@cloud nginx-1.20.1]# make

[root@cloud nginx-1.20.1]# make install</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="修改配置文件nginx-conf"><a class="anchor" href="#修改配置文件nginx-conf"></a>2.4.4. 修改配置文件nginx.conf</h4>
<div class="paragraph">
<p>配置文件在/opt/cloud/nginx路径下，可以按照github上readme对nginx.conf进行对比修改。ip请配置为当前服务器的ip。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>server {

listen 9104;

server_name 192.168.31.43;

location / {

root /opt/cloud/web/dist;

index index.html index.htm;

}

error_page 500 502 503 504 /50x.html;

location = /50x.html {

root html;

}

}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="启动nginx"><a class="anchor" href="#启动nginx"></a>2.4.5. 启动nginx</h4>
<div class="literalblock">
<div class="content">
<pre>[root@cloud sbin]# pwd

/opt/cloud/nginx/sbin

[root@cloud sbin]# ./nginx -c /opt/cloud/nginx/conf/nginx.conf

[root@cloud sbin]# ps -ef | grep nginx

root 2179 131037 0 09:46 pts/1 00:00:00 grep --color=auto nginx

root 55047 1 0 10月21 ? 00:00:00 nginx: master process ./nginx -c /opt/cloud/nginx/conf/nginx.conf

nobody 55048 55047 0 10月21 ? 00:00:00 nginx: worker process</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="operator部署"><a class="anchor" href="#operator部署"></a>2.5. operator部署</h3>
<div class="paragraph">
<p>请自行搭建K8S，此处描述为在K8S集群上安装ivory-operator和load镜像。</p>
</div>
<div class="sect3">
<h4 id="安装ivory-operator"><a class="anchor" href="#安装ivory-operator"></a>2.5.1. 安装ivory-operator</h4>
<div class="paragraph">
<p>参见</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/IvorySQL/ivory-operator/tree/IVYO_REL_5_STABLE">https://github.com/IvorySQL/ivory-operator/tree/IVYO_REL_5_STABLE</a></p>
</div>
<div class="paragraph">
<p>网站上的readme</p>
</div>
</div>
<div class="sect3">
<h4 id="load镜像"><a class="anchor" href="#load镜像"></a>2.5.2. load镜像</h4>
<div class="paragraph">
<p>如果服务器可以直接访问到docker hub,可以跳过该章节。否则需要在所有的K8S集群节点提前load 如下docker镜像</p>
</div>
<div class="literalblock">
<div class="content">
<pre>docker.io/ivorysql/pgadmin:ubi8-9.9-5.0-1

docker.io/ivorysql/pgbackrest:ubi8-2.56.0-5.0-1

docker.io/ivorysql/pgbouncer:ubi8-1.23.0-5.0-1

docker.io/ivorysql/postgres-exporter:ubi8-0.17.0-5.0-1

docker.io/ivorysql/ivorysql:ubi8-5.0-5.0-1

docker.io/prom/prometheus:v2.33.5

docker.io/prom/alertmanager:v0.22.2

docker.io/grafana/grafana:8.5.10</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="4.4.html">运维管理指南</a></span>
  <span class="next"><a href="4.7.2.html">IvorySQL Cloud使用</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">

</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/vendor/lunr-languages.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
