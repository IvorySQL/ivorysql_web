<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Compatible oracle-sequence :: IvorySQL Document Site</title>
    <link rel="canonical" href="https://docs.ivorysql.org/ivorysql-doc/Devs/Devs/5.html">
    <link rel="prev" href="4.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.ivorysql.org">IvorySQL Document Site</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://www.ivorysql.org/">Home</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ivorysql-doc" data-version="Devs">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="welcome.html">IvorySQL</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="welcome.html">Welcome.adoc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">List of features</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">New additions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="1.html">Ivorysql frame design</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="2.html">Case conversion</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="3.html">Added Oracle compatibility mode ports and IP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="4.html">Dual-mode design</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="5.html">Compatible oracle-sequence</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">IvorySQL</span>
    <span class="version">Devs</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="welcome.html">IvorySQL</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="welcome.html">Devs</a>
        </li>
        <li class="version">
          <a href="../../v2.2/v2.2/welcome.html">v2.2</a>
        </li>
        <li class="version">
          <a href="../../v2.1/v2.1/welcome.html">v2.1</a>
        </li>
        <li class="version">
          <a href="../../v1.5/v1.5/welcome.html">v1.5</a>
        </li>
        <li class="version">
          <a href="../../v1.4/v1.4/welcome.html">v1.4</a>
        </li>
        <li class="version">
          <a href="../../v1.3/v1.3/welcome.html">v1.3</a>
        </li>
        <li class="version">
          <a href="../../v1.2/v1.2/welcome.html">v1.2</a>
        </li>
        <li class="version">
          <a href="../../v1.1/v1.1/welcome.html">v1.1</a>
        </li>
        <li class="version">
          <a href="../../v1.0/v1.0/welcome.html">v1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="welcome.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="welcome.html">IvorySQL</a></li>
    <li>List of features</li>
    <li>New additions</li>
    <li><a href="5.html">Compatible oracle-sequence</a></li>
  </ul>
</nav>
  <div class="page-versions">
  <button class="version-menu-toggle" title="switch to Chinese">EN</button>
  <div class="version-menu">
    <a class="version is-current" href="">EN</a>
    <a class="version" href="../../../../cn/ivorysql-doc/Devs/Devs/5.html">CN</a>
  </div>
  </div>
  <div class="edit-this-page"><a href="https://github.com/IvorySQL/ivorysql_docs/edit/developer/EN/modules/ROOT/pages/Devs/5.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Compatible oracle-sequence</h1>
<div class="sect1">
<h2 id="objective"><a class="anchor" href="#objective"></a>1. Objective</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>In order to be compatible with Oracle-Sequence, it is necessary to improve the functionality of Postgres on the basis of the original SEQ to achieve the goal.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="feature-implementation"><a class="anchor" href="#feature-implementation"></a>2. Feature implementation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="create-sequence"><a class="anchor" href="#create-sequence"></a>2.1. Create sequence</h3>
<div class="ulist">
<ul>
<li>
<p>Including direct create sequence and create table fields with sequence attributes, the flowchart is as follows:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/p11.png" alt="p11">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Due to the differences between Oracle and PG SEQ, 3 features of the ORA SEQ have been added to the AttIdentity field in the pg_attri table:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">i: Represents the generated always option compatible with Oracle
o: Represents the generated by default option compatible with Oracle
n: Represents Oracle-compatible default on null option</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="alter-sequence"><a class="anchor" href="#alter-sequence"></a>2.2. Alter sequence</h3>
<div class="ulist">
<ul>
<li>
<p>Includes direct alter sequence and alter table with sequence attribute fields. The process is similar to the Create Sequence.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="updateinsert"><a class="anchor" href="#updateinsert"></a>2.3. Update/insert</h3>
<div class="ulist">
<ul>
<li>
<p>For sequence fields in the insert and update tables, some restrictions need to be made. As well as some of the attribute transformations that Oracle needs, the flowchart is as follows:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/p12.png" alt="p12">
</div>
</div>
</div>
<div class="sect2">
<h3 id="pg_dump"><a class="anchor" href="#pg_dump"></a>2.4. Pg_dump</h3>
<div class="ulist">
<ul>
<li>
<p>During the data export process, the SQL that creates the table is generated, and the value of the attidentity field in the pg_attri table needs to be determined to generate an SQL statement that creates orq seq</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-cases"><a class="anchor" href="#test-cases"></a>3. Test cases</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">create sequence test1
nomaxvalue
nominvalue
nocycle
cache 20
noorder
;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">postgres=# alter sequence test1
maxvalue 9999
minvalue 1
cycle
cache 2
order;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">dorp sequence test1;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">create table t2
(id int GENERATED BY DEFAULT AS IDENTITY start with 1,
 id2 int
 );</code></pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="4.html">Dual-mode design</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">

</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
